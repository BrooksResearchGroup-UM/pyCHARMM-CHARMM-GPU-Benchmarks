# pyCHARMM/CHARMM GPU Benchmarks
### This repository contains benchmarks for the CHARMM/pyCHARMM program for computations run on current GPU platforms. These include the standard JAC/DHFR, ApoA1, DMPG and STMV benchmarks, ranging in system size from ~23K atoms to ~1M atoms. In addition, new benchmarks illustrate the application of $MS\lambda D$ for both protein (T4 Lysoyme) and ligand (HSP90) relative free energy (RFE) calculations. The ApoA1, DMPG and STMV, as well as the two $MS\lambda D$ benchmarks have been updated to utilize the recent CHARMM 36 parameter sets. The JAC/DHFR benchmark is adapted from the early benchmark developed by Brooks and Case for CHARMM and Amber. 
### The benchmarks are all run from a single Python script at the top level of this repository, `benchmark.py`, and this set-up is mirrored in the Jupyter notebook `benchmark.ipynb`. An additional Jupyter notebook that can be utilized to plot the collected benchmarks resides in `plot_benchmarks.ipynb`.
### The benchmarks were largely run on hardware present in the Brooks lab at the University of Michigan, with exception of the data for the *RTX 4090*, *RTX 3080* and *RTX 3080 TI* which were generated by Parveen Gartan from Bergen University, Norway, on local hardware accessible to him.
### All benchmarks were run in replicate to provide statistical variance of the resulting numbers through a `slurm` queueing system and simple `slurm` job files are contained.
## DHFR/JAC benchmark - hydrogen mass repartitioning (HMR), 4 fs, NPT 
> ### pyCHARMM/OpenMM achieves better than $2\ \mu sec/day$ on DHFR/JAC bechmark.

<image src='figures/5_newDHFR.png' />

## ApoA1 nanodisc in water - hydrogen mass repartitioning (HMR), 4 fs, NPT 
> ### pyCHARMM/OpenMM achieves nearly  $600\ ns /day$ on ApoA1 bechmark.

<image src='figures/apoa1_bench.png' />

## DMPG membrane bilayer water - hydrogen mass repartitioning (HMR), 4 fs, NPT 
> ### pyCHARMM/OpenMM achieves greater than  $200\ ns /day$ on DMPG bechmark.

<image src='figures/6_dmpg.png' />

## 1M particle STMV in water - hydrogen mass repartitioning (HMR), 4 fs, NPT 
> ### pyCHARMM/OpenMM achieves nearly   $45\ ns /day$ on STMV bechmark.

<image src='figures/stmv_bench.png' />

# $MS\lambda D$ Free Energy Benchmarks with pyCHARMM/BLaDE and pyCHARMM/DOMDEC

## Multi-site ligand relative binding free energy calculations in HSP90 - hydrogen mass repartitioning (HMR), 4 fs, NPT 
> ### pyCHARMM/BLaDE achieves nearly   $45\ ns /day$ on STMV bechmark.

<image src='figures/stmv_bench.png' />

